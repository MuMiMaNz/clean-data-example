drop table if exists hdctemp.mumi_missing_data_stroke;
create table hdctemp.mumi_missing_data_stroke

 as SELECT  t2.cid, t2.sex, t2.birth, t2.education, t2.occupation_new, t2.typearea,
    t2.instype, t2.hospcode, t2.pid, t2.seq, t2.date_serv, t2.sbp, t2.dbp,
    row_number() over(partition by cid order by date_serv ASC) as ranking2
    
 FROM
  (
  SELECT  p.cid, p.sex, p.birth, p.education, p.occupation_new, p.typearea,
     t1.instype, t1.hospcode, t1.pid, t1.seq, t1.date_serv, t1.sbp, t1.dbp,
     row_number() over(partition by p.cid,t1.date_serv,t1.hospcode order by t1.date_serv ASC) as ranking
  FROM
   (
   SELECT  s.hospcode, s.pid, s.seq, s.instype, s.date_serv, s.sbp, s.dbp
   FROM  hdc.service s
    LEFT JOIN hdc.chospital x on s.hospcode = x.hoscode
   )as t1
  LEFT JOIN hdc.person p on t1.hospcode = p.hospcode AND t1.pid = p.pid
  WHERE p.cid IN (
    '8385b3145b716d2c42aa13bcf6888bb0',
    'f81dc25805f7a9f259ac0c56935d015a',
    '1b80a0e6c3c24de0538b5f1198ec342e',
    '71c5f1be39064de7a0dc0d9b4ae8cd54',
    'b3be26d6ef8487235c3efbb86f18a6e7',
    '7d831a820a2aa797243dbd4e8b647baa',
    '9d3aeb133e5aae15d3c7c9b68496d37a',
    'e09e7f3809b9962fa4838683cbf700bb',
    'dc81bd990b4477d64ef466e85cf829ac',
    '692dbe4dcae2b92d3b254e53fc312bd6',
    '37bd9bbb566135fc572302cfe0449c63',
    '24596147523e8a007622460bb5e3853f',
    '54ddddfb95ca4176d44d1e7eb11ccd31',
    'c5b821c9cb83caa7322f092f1592cdb4',
    'd13080e0acd7c28f9b3b4efdab3adb7e',
    'df65c9b6ed7ef38bcfc92e17f43ed615',
    'baf60b919dfa14fb029f4bd09198bba1',
    'f7525b983b6d9b40eccd74c6c21d04be',
    '80579e9154811520648039603137fd68',
    '7c1292ecbd75ba87c162b8f72c6f670d',
    '27e791d497f5d0ee1bda44babadd655f',
    '49f537c4970c56d08324a87e5a87a23d',
    'd936222ca20a46030635a4b27cd4cb0e',
    '29cc497cd70a12566561a999204b7573',
    '7dd8a5fee0badd65a0d6c6818e4bd7f2',
    '4d824e97a9c8b9f0ca5439d12a73f81e',
    '41cd061c77ddf0523d7f38d436beba30',
    '7e004a2c110a5639f913e353cd9a7839',
    'fd1a8cb09084f972225b5e9e5c4ceaa7',
    'e8ee15e1f22f27927ce655c4ddee6f71',
    'c3633809025b2f8d8e92a1e7a346c2b9',
    'ebf2f6a3de03faf172aa6cd06c5ef1f5',
    '77efa2d53852a9883df832e9f31946ee',
    'b0dd57836a97a619d983e2b90e42bc59',
    '5603116184b86f0328bab6bbab1b037f',
    '12f9c6be3ae9df618e941f2c510de0cb',
    '42c163dc517f4d71e5bbcf0db7705a50',
    'd37949e0d1962a4ae91726d770a12907',
    'a50edca9236c60086b661793fe04f1d7',
    'e0c18fb41624bcfd80a9c5a2969401c8',
    'f2f93ef93c4539569e698d9cb80242da',
    'b6098c371e940c8bbfaa380529d3a092',
    '3e160d679dc1691b00638f9dd81d9d5e',
    'dca3b8a5ab7b9a17235128e9408546ff',
    'fab5f642de14545d2f0ee29a1ec90d18',
    'd6645e83ebe541e132d46e25c9dbc145',
    '7f0c3ef59c48965e7f344c2f6d2212ff',
    '1938705f4156f564166c518e14371f82',
    'ab0349b62adce0f6e8aca80cb451c3f1',
    '0a4f87e95cace632866c2a8da84a823a',
    '0ba70f1bbbf59eb8fe9f8e860736c099',
    'f853e7dc7845127dccca585e6e7ff137',
    '196d5f032492b12760cf826e5a202d48',
    'd7380f68c4f7c893616caca1faf474d8',
    '744f62b420819395c591cc18908c9557',
    '2d3d0f66c8f98264a30afc08bdba7e37',
    '699f22ef35f1814970e456c5fb2da969',
    '96ad2fdb4411ca1d6feb0c83083d8ca6',
    'b03a81944d9ff77a215a809ac30c40df',
    '9234b1dd330f39822cbef99f3e3434ce',
    '15e712e894e880bd9a3e9cbcc822e775',
    '836fa33097f229e1912c935baf2e3d4f',
    'e8034fbce0a6774e2d6432255713bbae',
    '1b7d2d3d2d55f1677d2d01063341c0ab',
    '6a860d8882182e3728f719cfe103edd2',
    'fd17fbd64c361f623ff853b9d02ec435',
    '5f695a7f621232900c12ac4dd6122ead',
    '922323177bfb03a617a9e00f77ec3485',
    'ab8dc17aaed8f06c07ddd0c756cba883',
    '3a713d6e62ce00cf1081e14008d45c91',
    '7ab78febaf50443990be1e9cf4591775',
    'cbc44b3974b8a990be8c37c8b8ebdd26',
    '3233fe6d962da2a68bf7eae869bf5eba',
    'fe07c573b22bf945fd0a45bbcbf2c374',
    '02d58e15c1516f7f0af0385b0eefbbde',
    '8e4ed79619ff36c1ef5ef744cb65c094',
    'c94894f6a9565c677067e988908ed3ca',
    'd1c984bf46a5c3ffe6a1423e9995db62',
    'd8b05126807ce9d7945cefc0f2e6e2a2',
    'dbb9c6f22612c0d17a25a099c6bd65fc',
    'f1249f2efde78feb16125499bdb846db',
    '1ecbdba3c89b8ae05a95fdfff6029db1',
    '44f52691a1affff4bb6c09cf63e57716',
    'e0d66fe86df2ac0d39da8d6b1639ab51',
    '7e655b887cdc0167e8586f8c4fceba39',
    '988ed3a0f58703db375642d37564b4ec',
    '94193b942f10029c1a128163bb7fef22',
    '35160ef73118504c200ec8f4756f6e71',
    '8834a18d38a0a1506efebaf76323a1b4',
    'a59f64dce1cf682922304d66227c835e',
    '72d9fef50287d830d0996c68074b4153',
    'b877316aed4f26a082b632d953e3946c',
    'fe9c3b2406c7e95ce360c3c26bcde54f',
    'e84865dc731592200569ab21bde33a79',
    'f40cb04bafa74cb79410e8566d5e0e88',
    '27fbd2dae8cb612cb00a30537f33fc7c',
    'e5c5e42de28bcccb2a9131c3c6e2e11b',
    '73e8bb2a7b00e135ec45962506af5821',
    '3fcdac3f749d0460d698bd13fd86875d',
    '3a6b5f306accdb7e69db5dd9d820631c',
    'a4273f17623698f290038147d2fdcbe6',
    'e3b03c7b0f2a4d4f2e6ac7dedea63a47',
    'e218f1f7335aa8f96b2810805f1bb6b6',
    '02d5930e4428cee843e842b60a65402d',
    'dc16707a78ea1795a2dfcb18e7fd23c3',
    '98704a92772577deb367e039a153057d',
    '9b337fd1cf564198dc28cd57ad2a49fc',
    'bea202bd80f5f2066907176633f57a20',
    'e18bf26da2db74cd3f15aa4f6d12d046',
    'ee7f834970db0a3ce8ef0ab85cb835b7',
    '2263277c81ed6f4f3d26bb08b4a180d0',
    'a5d985846654fa91f2a2ffb9417fc596',
    '89e4000f20bb1e8266851020015ed0c4',
    '78251f99fca929a9f53f7c964d926478',
    '03de1a515fd910dbf995c814e5f46fc2',
    '014ad35ee535628311f83355dda2fd66',
    '5a4c329d6f8e24d6b89896d80c141a9a',
    '083dd680fe1fc196f796883218f86e67',
    '9db7cdf55e906a91e9179fff9ceb3923',
    '5339f3865a8dc7b2e01b98acc2b20515',
    'e61d1f5997a9372f350eb12e1378c842',
    '7a91a0bd5f337f55b7e0637ce364c431',
    '8ae0d3d41913a04eecd7eb48ffd578eb',
    '81e38d72c335d6468e4ffa44ae513d28',
    'b7a60f80d2a3272e097e5540fee8b6c8',
    '8b1a2d2dab9eee3b5571c8b64c654ba7',
    '75c00f25844a75b4a6fcebace4aab113',
    'b04405df62331a10e38c18e978bd8e14',
    '6fdaec6c734651eadf3764963ba70b99',
    '60675660ddcb31d574f5c5adee068b8c',
    'f587a5f07160c7737cef3a7fa1f40e42',
    'cd1d5e4c56da5c017a8bac80a7c5e38f',
    'f2640a575011d71b33789c84c415beee',
    '6759d4b512963452b5c00de12480344b',
    '0127165dd5b7624e922c271d3c2880e7',
    '30be2aa78543a6d2facd88f88c1a9c97',
    '719650a2eb4f0f002ac42222a192ad20',
    'b3911b5862f30d0f6151d023cb224014',
    '417189f608baadb58c1a18b4b8151a41',
    'de1f6ceac54df798e855e19195e53a5d',
    'cf5865ddba699486c849a77c3a7ac677',
    '45195196609cfa329d600e5597097ac0',
    '1a500754f6d20b4c057b7b5a7bc622b7',
    'ecebd37e29196e06cf6b9733f6796ec5',
    'd4e29c6e4daae9b0f68ed7345f4a6bd3',
    'ddabe71250bec2dccef04000c357fd8a',
    '87499ab15c94949d88286ce0fcfd486e',
    'a812bca0c7cf62345616a9d11e32246e',
    '15b83f96c4045306b6d7031795811d3d',
    '79b4c141eb00038b2499ee5996bce515',
    'fe4176bf28a2771b6c9d9074f014bd1c',
    '87247f93b08692378057f0845b606bb7',
    '61b567d21b40092ddb0697b36b520e75',
    '18fe253dfd3aa44e945f78a9049571fb',
    'e06ec29ac4f262812bd04461980787de',
    '87b908571874a6ba724421ec19a84ff5',
    '9fb127f6b94290622d7a9537a4a00d57',
    '0f48f51793843fa77feda5f969431cc6',
    '465ff9029f26ec4b6ab3da543fce8ed2',
    '48166951db79a06da858d82cd4f3f24e',
    '6f3786487883e8b2be63f544e5b4def6',
    'be367409ead72eb507d67a25a92db170',
    '50ce708a3470cf5b212ac65870275583',
    '69e19063b57bdf36206881fbfdfc2b2f',
    'dce2cebe95e7772a5a3009b00025cbb1',
    'e71ba76a610cc44c1bc3d66360a197ad'
    )
  )as t2
WHERE ranking = 1